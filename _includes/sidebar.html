{% if page.author_profile or layout.author_profile or page.sidebar %}
  <div class="sidebar sticky">
  {% if page.author_profile or layout.author_profile %}{% include author-profile.html %}{% endif %}
  {% if page.sidebar %}
    {% for s in page.sidebar %}
      {% if s.image %}
        <img src= "{{ s.image }}" alt="{% if s.image_alt %}{{ s.image_alt }}{% endif %}">
      {% endif %}
      {% if s.title %}<h3>{{ s.title }}</h3>{% endif %}
      {% if s.text %}{{ s.text | markdownify }}{% endif %}
    {% endfor %}
  {% endif %}
  
  <!-- ClustrMaps Visitor Location Widget -->
  <div style="margin-top: 2em;" id="clustrmaps-container">
    <script type="text/javascript" id="clustrmaps" src="//clustrmaps.com/map_v2.js?d=zcKsgs8kNMzvRK_kuyZiuRBJ995e7JyoAjE-Ii3ovdQ&cl=ffffff&w=a"></script>
    <script>
      // Hide visitor count after ClustrMaps loads
      setTimeout(function() {
        var container = document.getElementById('clustrmaps-container');
        if (container) {
          // Hide all links to ClustrMaps site (which contain visitor count)
          var links = container.querySelectorAll('a[href*="clustrmaps.com"]');
          links.forEach(function(link) {
            link.style.display = 'none';
          });
          // Hide any text nodes that might contain visitor count
          var allElements = container.querySelectorAll('*');
          allElements.forEach(function(el) {
            if (el.textContent && (el.textContent.includes('visitors') || el.textContent.includes('Visitors'))) {
              if (el.tagName !== 'SCRIPT' && el.tagName !== 'NOSCRIPT') {
                el.style.display = 'none';
              }
            }
          });
        }
      }, 1000);
    </script>
  </div>
  
  </div>
{% endif %}